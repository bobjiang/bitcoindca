"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[752],{6879:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var s=i(3303);const t={},o=s.createContext(t);function r(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(o.Provider,{value:n},e.children)}},9500:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"developer/integration-guide","title":"Integration Guide","description":"Implement keepers, monitoring, Safe App flows, and external notifications on top of DCA Crypto.","source":"@site/docs/developer/integration-guide.md","sourceDirName":"developer","slug":"/developer/integration-guide","permalink":"/docs/developer/integration-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/bobjiang/dcacrypto/tree/main/docs/docs/developer/integration-guide.md","tags":[],"version":"current","frontMatter":{"title":"Integration Guide","sidebar_label":"Integration Guide","description":"Implement keepers, monitoring, Safe App flows, and external notifications on top of DCA Crypto."},"sidebar":"primarySidebar","previous":{"title":"Smart Contracts","permalink":"/docs/developer/smart-contracts"},"next":{"title":"SDKs & Tools","permalink":"/docs/developer/sdk-and-tools"}}');var t=i(7711),o=i(6879);const r={title:"Integration Guide",sidebar_label:"Integration Guide",description:"Implement keepers, monitoring, Safe App flows, and external notifications on top of DCA Crypto."},c="Integration Guide",l={},d=[{value:"Keeper integration",id:"keeper-integration",level:2},{value:"Chainlink Automation",id:"chainlink-automation",level:3},{value:"Gelato fallback",id:"gelato-fallback",level:3},{value:"Public execution",id:"public-execution",level:3},{value:"Indexing &amp; analytics",id:"indexing--analytics",level:2},{value:"Edge case monitoring",id:"edge-case-monitoring",level:3},{value:"Safe App considerations",id:"safe-app-considerations",level:2},{value:"Notifications &amp; webhooks",id:"notifications--webhooks",level:2},{value:"Deployment automation",id:"deployment-automation",level:2},{value:"Working with docs",id:"working-with-docs",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"integration-guide",children:"Integration Guide"})}),"\n",(0,t.jsx)(n.p,{children:"This guide targets developers building on top of the protocol\u2014keepers, dashboards, analytics, and treasury automation."}),"\n",(0,t.jsx)(n.h2,{id:"keeper-integration",children:"Keeper integration"}),"\n",(0,t.jsx)(n.h3,{id:"chainlink-automation",children:"Chainlink Automation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Register the ",(0,t.jsx)(n.code,{children:"Executor"})," contract with your Chainlink registrar."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"checkUpkeep"}),"-style simulations rely on ",(0,t.jsx)(n.code,{children:"Executor.simulate(positionId)"})," and ",(0,t.jsx)(n.code,{children:"DcaManager.isPositionEligible"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Batch multiple ",(0,t.jsx)(n.code,{children:"positionIds"})," via ",(0,t.jsx)(n.code,{children:"Executor.batchExecute"})," to optimise gas."]}),"\n",(0,t.jsxs)(n.li,{children:["Chainlink nodes need ",(0,t.jsx)(n.code,{children:"KEEPER_ROLE"}),". Grant via multisig:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-solidity",metastring:'title="scripts/grantKeeper.ts"',children:"await executor.grantRole(EXECUTOR_ROLE, chainlinkRegistry);\nawait executor.grantRole(KEEPER_ROLE, chainlinkRegistry);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"gelato-fallback",children:"Gelato fallback"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Mirror Chainlink conditions in Gelato tasks."}),"\n",(0,t.jsxs)(n.li,{children:["Respect the same grace period defined in ",(0,t.jsx)(n.code,{children:"PROTOCOL_CONSTANTS.executionGracePeriodSeconds"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Use the ",(0,t.jsx)(n.code,{children:"ExecutionSkipped"})," event to stop retries if a guard is repeatedly tripping."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"public-execution",children:"Public execution"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Executors can expose a UI toggle allowing community members to trigger ",(0,t.jsx)(n.code,{children:"execute"})," after the grace window."]}),"\n",(0,t.jsxs)(n.li,{children:["Check skip reasons to avoid burning gas (",(0,t.jsx)(n.code,{children:"PRICE_DEVIATION"}),", ",(0,t.jsx)(n.code,{children:"GAS_CAP"}),", ",(0,t.jsx)(n.code,{children:"DEPEG"}),")."]}),"\n",(0,t.jsx)(n.li,{children:"The public path halves slippage tolerance; notify users accordingly."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"indexing--analytics",children:"Indexing & analytics"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Subscribe to the events defined in ",(0,t.jsx)(n.a,{href:"/docs/reference/events",children:"Reference > Events"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"ExecutionDetails"})," event includes:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"gasUsed"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"routePath"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"priceImpactBps"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"twapWindow"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"oracleTimestamp"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Store historical executions to compute realised cost basis per position."}),"\n",(0,t.jsxs)(n.li,{children:["Fetch per-position balances via ",(0,t.jsx)(n.code,{children:"getPositionBalance(positionId)"}),"\u2014this is the same data the dashboard uses."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"edge-case-monitoring",children:"Edge case monitoring"}),"\n",(0,t.jsx)(n.p,{children:"Leverage the test suite to understand expected behaviour:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"contracts/test/security/MEVProtection.test.ts"})," documents reasons emitted when private execution fails."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"contracts/test/security/DOSProtection.test.ts"})," showcases pause/circuit breaker events."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"contracts/test/system.behavior.spec.ts"})," demonstrates the expected state transitions after success and skip."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"safe-app-considerations",children:"Safe App considerations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Safe mode verifies ",(0,t.jsx)(n.code,{children:"msg.sender"})," matches a Safe module or owner depending on configuration."]}),"\n",(0,t.jsx)(n.li,{children:"Support batched transactions (create + deposit) via Safe\u2019s multi-send."}),"\n",(0,t.jsx)(n.li,{children:"Respect Safe\u2019s nonce management to avoid stuck positions."}),"\n",(0,t.jsx)(n.li,{children:"Provide a review screen summarising guards and limits before creation\u2014mirroring the UI prevents misconfiguration."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"notifications--webhooks",children:"Notifications & webhooks"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Publish execution summaries to EPNS or custom webhook endpoints:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="Webhook payload"',children:'{\n  "positionId": "42",\n  "owner": "0xabc...",\n  "keeper": "0xdef...",\n  "status": "EXECUTED",\n  "amountIn": "500000000",\n  "amountOut": "8732100",\n  "venue": "AUTO",\n  "priceUsd": "71600.23",\n  "nextExecAt": 1735336800,\n  "skipReason": null\n}\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["On skips, populate ",(0,t.jsx)(n.code,{children:'status: "SKIPPED"'})," and set ",(0,t.jsx)(n.code,{children:"skipReason"})," to one of the canonical strings (see ",(0,t.jsx)(n.code,{children:"frontend/lib/protocol.ts"})," ",(0,t.jsx)(n.code,{children:"EXECUTION_REASONS"}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"deployment-automation",children:"Deployment automation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Deployment scripts live in ",(0,t.jsx)(n.code,{children:"contracts/scripts"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Provide environment variables for each network (",(0,t.jsx)(n.code,{children:"CHAINLINK_REGISTRAR"}),", ",(0,t.jsx)(n.code,{children:"GELATO_AUTOMATE"}),", ",(0,t.jsx)(n.code,{children:"FLASHBOTS_RELAY"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:["Run ",(0,t.jsx)(n.code,{children:"pnpm -F contracts deploy --network mainnet"})," with multisig sign-off."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"working-with-docs",children:"Working with docs"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Add custom integration guides under ",(0,t.jsx)(n.code,{children:"docs/docs/developer/"})," and update ",(0,t.jsx)(n.code,{children:"sidebars.ts"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Run ",(0,t.jsx)(n.code,{children:"pnpm -F docs build"})," to confirm no broken links before publishing."]}),"\n",(0,t.jsxs)(n.li,{children:["If integration changes modify public signatures, update the ",(0,t.jsx)(n.a,{href:"/docs/developer/smart-contracts",children:"Smart Contract Reference"})," and ",(0,t.jsx)(n.a,{href:"/docs/reference/api-reference",children:"API Reference"})," concurrently."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);