"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[892],{6879:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>o});var r=i(3303);const t={},s=r.createContext(t);function c(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(s.Provider,{value:n},e.children)}},8454:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"developer/architecture","title":"Architecture Overview","description":"High-level view of contracts, automation, routing, and off-chain components that make up BitcoinDCA.","source":"@site/docs/developer/architecture.md","sourceDirName":"developer","slug":"/developer/architecture","permalink":"/docs/developer/architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/bobjiang/bitcoindca/tree/main/docs/docs/developer/architecture.md","tags":[],"version":"current","frontMatter":{"title":"Architecture Overview","sidebar_label":"Architecture","description":"High-level view of contracts, automation, routing, and off-chain components that make up BitcoinDCA."},"sidebar":"primarySidebar","previous":{"title":"Use Cases","permalink":"/docs/user-guides/use-cases"},"next":{"title":"Smart Contracts","permalink":"/docs/developer/smart-contracts"}}');var t=i(7711),s=i(6879);const c={title:"Architecture Overview",sidebar_label:"Architecture",description:"High-level view of contracts, automation, routing, and off-chain components that make up BitcoinDCA."},o="Architecture Overview",a={},l=[{value:"Component map",id:"component-map",level:2},{value:"Execution flow",id:"execution-flow",level:2},{value:"Deployment topology",id:"deployment-topology",level:2},{value:"Data contracts",id:"data-contracts",level:2},{value:"Frontend integration",id:"frontend-integration",level:2},{value:"Documentation site",id:"documentation-site",level:2},{value:"Further reading",id:"further-reading",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"architecture-overview",children:"Architecture Overview"})}),"\n",(0,t.jsxs)(n.p,{children:["BitcoinDCA is a layered system that harmonises on-chain smart contracts with off-chain automation and analytics. This page condenses ",(0,t.jsx)(n.code,{children:"architecture.md"})," while linking to implementation specifics."]}),"\n",(0,t.jsx)(n.h2,{id:"component-map",children:"Component map"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Smart contracts"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"DcaManager"})," \u2014 Position lifecycle, guard configuration, accounting, limits."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"PositionNFT"})," \u2014 ERC-721 ownership tokens with metadata stored separately for upgrade safety."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Executor"})," \u2014 Non-reentrant execution entrypoint for keepers (Chainlink, Gelato, public)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"PriceOracle"})," \u2014 Aggregates Chainlink feeds and Uniswap v3 TWAPs."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Router adapters"})," \u2014 ",(0,t.jsx)(n.code,{children:"UniV3Adapter"}),", ",(0,t.jsx)(n.code,{children:"CowAdapter"}),", ",(0,t.jsx)(n.code,{children:"OneInchAdapter"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Treasury"})," \u2014 Multisig/timelock-controlled fee sink."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automation layer"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Chainlink Automation"})," \u2014 Primary scheduler, monitors ",(0,t.jsx)(n.code,{children:"nextExecAt"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Gelato"})," \u2014 Secondary scheduler replicating checks."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Public fallback"})," \u2014 Anyone can execute after a grace window, collecting a capped tip."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Off-chain services"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Subgraph / Indexers"})," \u2014 Index events for analytics."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Monitoring"})," \u2014 Sentry, Prometheus, or custom infra consuming ",(0,t.jsx)(n.code,{children:"ExecutionDetails"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Notifications"})," \u2014 EPNS/webhook for user alerts."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Refer to ",(0,t.jsx)(n.code,{children:"/architecture.md"})," for full diagrams, circuit breaker matrices, and deployment topologies."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"execution-flow",children:"Execution flow"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["User creates a position via ",(0,t.jsx)(n.code,{children:"DcaManager.createPosition"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Automation stack watches ",(0,t.jsx)(n.code,{children:"nextExecAt"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Executor enforces guards and dispatches to the appropriate router."}),"\n",(0,t.jsx)(n.li,{children:"Router interacts with DEX venue (Uniswap v3, CoW, 1inch)."}),"\n",(0,t.jsx)(n.li,{children:"Settlement updates balances and emits events."}),"\n",(0,t.jsx)(n.li,{children:"Off-chain indexers persist events for UI dashboards and analytics."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"deployment-topology",children:"Deployment topology"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Proxy pattern"})," \u2014 UUPS proxies for upgradability. The behaviour tests assert the correctness of proxy addresses using Hardhat\u2019s ",(0,t.jsx)(n.code,{children:"upgrades"})," helper."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Multisig + timelock"})," \u2014 Administrative actions require multisig approval and optional delay."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Router permissions"})," \u2014 Only whitelisted adapters can be invoked via ",(0,t.jsx)(n.code,{children:"setVenueConfig"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"data-contracts",children:"Data contracts"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Position storage"})," \u2014 Lives in a dedicated storage contract to preserve layout across upgrades."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Telemetry"})," \u2014 Events capture status, gas usage, and route decisions. ",(0,t.jsx)(n.code,{children:"ExecutionDetails"})," includes route path bytes and price impact bps for analytics pipelines."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"System configuration"})," \u2014 Structs such as ",(0,t.jsx)(n.code,{children:"ProtocolConfig"}),", ",(0,t.jsx)(n.code,{children:"CircuitBreakerConfig"}),", and ",(0,t.jsx)(n.code,{children:"VenueConfig"})," allow fine-grained adjustments without redeploying contracts."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"frontend-integration",children:"Frontend integration"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Next.js app (",(0,t.jsx)(n.code,{children:"frontend"})," workspace) uses ",(0,t.jsx)(n.code,{children:"wagmi"})," and ",(0,t.jsx)(n.code,{children:"viem"})," for contract reads/writes."]}),"\n",(0,t.jsx)(n.li,{children:"Safe App mode injects Safe SDK, with guards preventing non-owner submissions."}),"\n",(0,t.jsx)(n.li,{children:"Real-time data sourced from on-chain reads + subgraph caches for historical execution metrics."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"documentation-site",children:"Documentation site"}),"\n",(0,t.jsxs)(n.p,{children:["This Docusaurus package (",(0,t.jsx)(n.code,{children:"docs"}),") mirrors Aave\u2019s navigation model. The local search plugin indexes all Markdown files, enabling offline-friendly ops docs for keepers."]}),"\n",(0,t.jsx)(n.h2,{id:"further-reading",children:"Further reading"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/developer/smart-contracts",children:"Smart Contract Reference"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/developer/integration-guide",children:"Integration Guide"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/developer/testing",children:"Testing Playbooks"})}),"\n",(0,t.jsxs)(n.li,{children:["Root documents: ",(0,t.jsx)(n.a,{href:"https://github.com/bobjiang/bitcoindca/blob/main/architecture.md",children:(0,t.jsx)(n.code,{children:"architecture.md"})}),", ",(0,t.jsx)(n.a,{href:"https://github.com/bobjiang/bitcoindca/blob/main/user-flow.md",children:(0,t.jsx)(n.code,{children:"user-flow.md"})}),", ",(0,t.jsx)(n.a,{href:"https://github.com/bobjiang/bitcoindca/blob/main/AGENTS.md",children:(0,t.jsx)(n.code,{children:"AGENTS.md"})})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);