"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[408],{778:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"user-guides/manage-balances","title":"Manage Positions & Balances","description":"Learn how to pause, resume, modify, and withdraw from DCA Crypto positions with full guard awareness.","source":"@site/docs/user-guides/manage-balances.md","sourceDirName":"user-guides","slug":"/user-guides/manage-balances","permalink":"/docs/user-guides/manage-balances","draft":false,"unlisted":false,"editUrl":"https://github.com/bobjiang/dcacrypto/tree/main/docs/docs/user-guides/manage-balances.md","tags":[],"version":"current","frontMatter":{"title":"Manage Positions & Balances","sidebar_label":"Manage Positions","description":"Learn how to pause, resume, modify, and withdraw from DCA Crypto positions with full guard awareness."},"sidebar":"primarySidebar","previous":{"title":"Create a Position","permalink":"/docs/user-guides/create-position"},"next":{"title":"Use Cases","permalink":"/docs/user-guides/use-cases"}}');var t=i(7711),r=i(6879);const o={title:"Manage Positions & Balances",sidebar_label:"Manage Positions",description:"Learn how to pause, resume, modify, and withdraw from DCA Crypto positions with full guard awareness."},a="Manage Positions & Balances",d={},c=[{value:"Pause and resume",id:"pause-and-resume",level:2},{value:"Modify parameters",id:"modify-parameters",level:2},{value:"Top up or withdraw balances",id:"top-up-or-withdraw-balances",level:2},{value:"Cancel a position",id:"cancel-a-position",level:2},{value:"Emergency withdrawal",id:"emergency-withdrawal",level:2},{value:"Monitoring executions",id:"monitoring-executions",level:2},{value:"Notifications",id:"notifications",level:2},{value:"Best practices",id:"best-practices",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"manage-positions--balances",children:"Manage Positions & Balances"})}),"\n",(0,t.jsx)(n.p,{children:"Once a position is live, you have fine-grained controls to react to markets or liquidity needs."}),"\n",(0,t.jsx)(n.h2,{id:"pause-and-resume",children:"Pause and resume"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Pause:"})," Halts new executions without touching deposited funds. Useful for volatile markets."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["UI action calls ",(0,t.jsx)(n.code,{children:"pause(positionId)"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["The executor emits ",(0,t.jsx)(n.code,{children:'ExecutionSkipped(positionId, "PAUSED")'})," if keepers attempt execution while paused."]}),"\n",(0,t.jsxs)(n.li,{children:["Covered by ",(0,t.jsx)(n.code,{children:"contracts/test/security/DOSProtection.test.ts"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Resume:"})," Restarts scheduling, recalculating ",(0,t.jsx)(n.code,{children:"nextExecAt"})," to the next valid window."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"modify-parameters",children:"Modify parameters"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"modify(positionId, ModifyParams)"})," lets you adjust guardrails without recreating the position. Mutable fields include:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"slippageBps"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"maxPriceDeviationBps"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"twapWindow"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"priceCapUsd"})," / ",(0,t.jsx)(n.code,{children:"priceFloorUsd"})]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"venue"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"MEV mode"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"maxBaseFeeWei"})," / ",(0,t.jsx)(n.code,{children:"maxPriorityFeeWei"})]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"beneficiary"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Immutable fields (quote/base assets, amount per period, start/end times) require cancelling and creating a new position. Attempting to modify them reverts with ",(0,t.jsx)(n.code,{children:"ImmutableField()"})," as enforced in ",(0,t.jsx)(n.code,{children:"contracts/test/dcaManager.abi.spec.ts"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"top-up-or-withdraw-balances",children:"Top up or withdraw balances"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Deposit:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",metastring:'title="frontend/hooks/usePositionActions.tsx"',children:"await manager.deposit(positionId, tokenAddress, amount);\n"})}),"\n",(0,t.jsx)(n.p,{children:"Increases idle funds. Deposits are idempotent and may be batched."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Withdraw:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-solidity",metastring:'title="contracts/interfaces/IDcaManager.sol"',children:"function withdraw(\n  uint256 positionId,\n  address token,\n  uint256 amount,\n  address to\n) external;\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Lets owners reclaim excess funds or collected base asset. ",(0,t.jsx)(n.code,{children:"to"})," defaults to the beneficiary when called from the UI."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Withdrawals emit ",(0,t.jsx)(n.code,{children:"Withdrawn(positionId, token, amount, to)"})," which the dashboard displays in the activity timeline."]}),"\n",(0,t.jsx)(n.h2,{id:"cancel-a-position",children:"Cancel a position"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Calls ",(0,t.jsx)(n.code,{children:"cancel(positionId)"})," to close the strategy."]}),"\n",(0,t.jsx)(n.li,{children:"Refunds remaining balances to the beneficiary."}),"\n",(0,t.jsxs)(n.li,{children:["Burns the ",(0,t.jsx)(n.code,{children:"PositionNFT"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Execution attempts afterwards revert with ",(0,t.jsx)(n.code,{children:"PositionNotActive"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"emergency-withdrawal",children:"Emergency withdrawal"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"emergencyWithdraw(positionId)"})," starts a two-step process:","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Arm the withdrawal with a timelock delay (recorded on-chain)."}),"\n",(0,t.jsxs)(n.li,{children:["After the delay, call ",(0,t.jsx)(n.code,{children:"completeEmergencyWithdraw"})," to transfer all funds."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Intended for venue outages or severe oracle issues."}),"\n",(0,t.jsxs)(n.li,{children:["Validated by ",(0,t.jsx)(n.code,{children:"contracts/test/security/Reentrancy.test.ts"})," to ensure state integrity."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"monitoring-executions",children:"Monitoring executions"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The activity feed renders ",(0,t.jsx)(n.code,{children:"ExecutionCompleted"}),", ",(0,t.jsx)(n.code,{children:"ExecutionSkipped"}),", ",(0,t.jsx)(n.code,{children:"Deposited"}),", and ",(0,t.jsx)(n.code,{children:"Withdrawn"})," events."]}),"\n",(0,t.jsx)(n.li,{children:"The dashboard compares TWAP vs execution price, highlighting deviations beyond tolerated bounds."}),"\n",(0,t.jsxs)(n.li,{children:["For custom tooling, subscribe to events in the ",(0,t.jsx)(n.a,{href:"/docs/reference/events",children:"Reference > Events"})," section."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"notifications",children:"Notifications"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Optional integrations with EPNS/Webhooks (see ",(0,t.jsx)(n.a,{href:"/docs/developer/integration-guide#notifications--webhooks",children:"Integration Guide"}),") can alert you when executions succeed or guards trip."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best practices"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Keep at least 3 execution periods\u2019 worth of liquidity in the position to avoid churn."}),"\n",(0,t.jsxs)(n.li,{children:["Review guard failures promptly; persistent ",(0,t.jsx)(n.code,{children:"PRICE_DEVIATION"})," may indicate stale or mispriced feeds."]}),"\n",(0,t.jsx)(n.li,{children:"If you rely on the public executor fallback, revisit gas caps to balance speed vs cost."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},6879:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var s=i(3303);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);